---
title: "CU Psychology R Tutorial: Descriptives"
output: 
  html_document: 
    toc: true
    toc_float: true
---

# Return home

Click [here](https://cu-psych-r-users.github.io/cu-psych-r-tutorial) to return to the main CU psychology R tutorials page.

# Goals for this tutorial:

1. Learn how to group and categorize data in R 
2. Learn how to generate descriptive statistics in R

# 0. Open dataset and load package

This dataset examines the relationship between multitasking and working memory. [Link here to original paper by Uncapher et al. 2016.](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4733435/pdf/nihms712443.pdf)

```{r, message = FALSE, warning = FALSE}
# use read.csv function to open data into R 
df <- read.csv("uncapher_2016_repeated_measures_dataset.csv")

# we will continue using tidyverse tools
library(tidyverse)
```

# 1. Familiarize yourself with the data

Quick review from [data cleaning](2_dataCleaning/DataCleaning_Code.html): take a look at the basic data structure, number of rows and columns.

```{r}
# base R functions
head(df)
nrow(df)
ncol(df)
names(df)
```

# 2. Selecting relevant variables

Sometimes datasets have many variables that are unnecessary for a given analysis. To simplify your life, and your code, we can select only the given variables we'd like to use for now.

```{r}
# tidyverse select() function 
df <- df %>% 
  select(subjNum, groupStatus, adhd, hitRate, faRate, dprime)
```

# 3. Basic Descriptives

## Summarizing data

Let's learn how to make simple tables of summary statistics.
First, we will calculate summary info across all data using `summarize()`, a useful function for creating summaries. Like `mutate()`, it can take mutiple functions as arguments. Note that we're not creating a new object for this summary (i.e. not using the `<-` symbol), so this will print but not save.

```{r}
 df %>% 
  summarize(min_HR = min(hitRate, na.rm = T),
            max_HR = max(hitRate, na.rm = T), 
            mean_HR = mean(hitRate, na.rm= T), 
            sd_HR = sd(hitRate, na.rm = T))
```

# 4. Grouping data

Next, we will learn how to group data based on certain variables of interest.

We will use the `group_by()` function in tidyverse, which will automatically group any subsequent actions called on the data. 

```{r}
 df %>% 
  # split the summary statistics by group 
  group_by(groupStatus) %>%
  summarize(meanHitRate = mean(hitRate, na.rm= T), 
            meanFalseAlarm= mean(faRate, na.rm= T),
            meanDprime = mean(dprime, na.rm = T))
```

We can group data by more than one factor. Let's say we're interested in how levels of ADHD interact with `groupStatus` (multitasking: high or low). We will make a factor for ADHD (mean-split), and add it as a grouping variable.

```{r}
 df <- df %>% 
   # if adhd score is lower than mean, label "low", else label "high""
   mutate(adhdF = ifelse(adhd < mean(adhd), "Low", "High")) 
```

Then we'll check how evenly split these groups are.

```{r}
df %>%
  # split the summary statistics by group 
  group_by(adhdF, groupStatus) %>%
  # how many data points are in each group? n() will calculate this for us.
  summarize(n = n())
```

Then we'll calculate some summary info on these groups.

```{r}
df %>%
    group_by(adhdF, groupStatus) %>%
    summarize(meanHitRate = mean(hitRate, na.rm= T), 
            meanFalseAlarm= mean(faRate, na.rm= T),
            meanDprime = mean(dprime, na.rm = T))
```

# 5. Extra: Working with a long dataset 

This is a repeated measures ("long") dataset, with multiple rows per subject. This makes things a bit tricker, but we are going to show you some tools for how to work with "long" datasets.

## How many unique subjects are in the data

```{r}
# Get a list of subjects using unique()
SubList <- unique(df$subjNum)

# how many subjects are in this dataframe?
Nsubs <- length(SubList)

```

## Make sure you know how many trials there were per subj.

```{r}
df %>%
  group_by (subjNum) %>%
  summarize (nTrials = n())
```

## Combine summary statistics with the full data frame

For some analyses, you might want to add a higher level variable (e.g. subject average hitRate) alongside your long data. We can do this by summarizing the data in a new data frame and then merging it with the full data.

```{r}
avgHR <- df %>% 
  group_by(subjNum) %>% 
  summarize(avgHR = mean(hitRate, na.rm=T))

df <- merge(df, avgHR, by="subjNum")

# you should now have an avgHR column in df, which will repeat within each subject, but vary across subjects.
```


# 6. saving your work

## Saving tables into csv files

```{r}
 basic_descriptives <-  df %>% 
   # if adhd score is lower than mean, label "low", else label "high""
   mutate(adhdF = ifelse(adhd < mean(adhd), "Low", "High")) %>%
  # split the summary statistics by group 
  group_by(adhdF, groupStatus) %>%
  summarize(meanHitRate = mean(hitRate, na.rm= T), 
            meanFalseAlarm= mean(faRate, na.rm= T),
            meanDprime = mean(dprime, na.rm = T))
```

```{r, eval = FALSE}
# use write.csv() to save this out!
write.csv(basic_descriptives, file = "myDescriptives.csv")


# note : it will automatically save to your working directory unless you specify otherise 
# remember to check your working directory, use getwd() 
# If you don't want to save into your working directory,
# add the path manually "/dir/dir/dir/filename.csv"
```
